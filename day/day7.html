<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>LÃ¥ge 7 â€“ Sorter julegaver</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #204226;
  margin: 0;
  padding: 0;
  color: white;
  text-align: center;
}

.content-box {
  background-color: white;
  color: black;
  padding: 20px;
  border-radius: 12px;
  max-width: 500px;
  margin: 40px auto;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  position: relative;
}

#gameArea {
  position: relative;
  width: 400px;
  height: 400px;
  margin: 0 auto;
  overflow: hidden;
}

#maskineBaggrund, #maskineFront {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

#maskineBaggrund { z-index: 0; }
.gift { 
  position: absolute;
  top: 200px;
  z-index: 1;
}
#maskineFront { z-index: 3; }

.sack {
  width: 90px;
  height: 120px;
  margin: 0 5px;
  cursor: pointer;
}

.sacks {
  display: flex;
  justify-content: center;
  margin-top: 10px;
  gap: 10px;
}

.back-button {
  display: inline-block;
  margin-top: 20px;
  padding: 10px 16px;
  background-color: #204226;
  color: white;
  text-decoration: none;
  border-radius: 8px;
  font-weight: bold;
}

.back-button:hover {
  background-color: #35663c;
}

#scoreDisplay {
  font-weight: bold;
  margin-top: 10px;
  font-size: 18px;
  color: #204226;
}

#endScreen {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #204226;
  color: white;
  padding: 20px;
  border-radius: 12px;
  font-size: 18px;
  font-weight: bold;
  z-index: 5;
}
</style>
</head>
<body>
<h1>GlÃ¦delig 7. december â€“ Sorter julegaverne!</h1>
<div class="content-box">
  <div id="gameArea">
    <img id="maskineBaggrund" src="../assets/sorterMaskineBag.svg" alt="Baggrund maskine">
    <img id="maskineFront" src="../assets/sorterMaskineFront.svg" alt="Foran maskine">
    <div id="endScreen"></div>
  </div>

  <div class="sacks">
    <img class="sack" src="../assets/sorterBlÃ¥SÃ¦k.svg" data-farve="blÃ¥">
    <img class="sack" src="../assets/sorterRÃ¸dSÃ¦k.svg" data-farve="rÃ¸d">
    <img class="sack" src="../assets/sorterGrÃ¸nSÃ¦k.svg" data-farve="grÃ¸n">
    <img class="sack" src="../assets/sorterGulSÃ¦k.svg" data-farve="gul">
  </div>

  <div id="scoreDisplay">Score: 0</div>
  <p><a href="../index.html" class="back-button">â¬… Tilbage til kalenderen</a></p>
</div>

<script>
const colors = ["blÃ¥","rÃ¸d","grÃ¸n","gul"];
let gifts = [];

// Opret pakker: 4 farver Ã— 4 stÃ¸rrelser
colors.forEach(farve => {
  for(let size=1; size<=4; size++){
    gifts.push({color: farve, size: size, caught: false, imgEl: null});
  }
});

// Bland pakkerne random
gifts = gifts.sort(()=> Math.random() - 0.5);

let score = 0;
const gameArea = document.getElementById("gameArea");
const endScreen = document.getElementById("endScreen");

// StÃ¸rrelser (dobbelt sÃ¥ store)
const sizes = {
  1: {w: 26.5, h: 26.5},
  2: {w: 34, h: 26.5},
  3: {w: 30, h: 18},
  4: {w: 19, h: 26.5}
};

function spawnGift(gift, delay){
  setTimeout(()=>{
    const img = document.createElement("img");
    img.src = `../assets/sorter${gift.color.charAt(0).toUpperCase() + gift.color.slice(1)}${gift.size}.svg`;
    img.classList.add("gift");
    img.style.left = "-40px";
    img.style.width = sizes[gift.size].w + "px";
    img.style.height = sizes[gift.size].h + "px";
    gameArea.appendChild(img);
    gift.imgEl = img;

    const speed = 1; // langsommere
    const moveInterval = setInterval(()=>{
      if(!img.parentNode){ clearInterval(moveInterval); return; }
      let left = parseFloat(img.style.left);
      img.style.left = (left + speed) + "px";

      if(left > 400){ // passerer hÃ¸jre kant
        clearInterval(moveInterval);
        if(img.parentNode) img.parentNode.removeChild(img);
        checkEndGame();
      }
    }, 20);
  }, delay);
}

// Start alle pakker med forskudt timing, sÃ¥ de ikke overlapper
gifts.forEach((gift, i)=>{
  spawnGift(gift, i * 800); // 0,8s mellem hver pakke
});

// HÃ¥ndtering af sÃ¦kke
document.querySelectorAll(".sack").forEach(sack=>{
  sack.addEventListener("click", ()=>{
    const sackLeft = sack.offsetLeft;
    gifts.forEach(gift=>{
      if(gift.caught || !gift.imgEl) return;
      const giftLeft = parseFloat(gift.imgEl.style.left);
      const giftRight = giftLeft + gift.imgEl.width;
      if(giftRight > sackLeft && giftLeft < sackLeft + sack.offsetWidth){
        gift.caught = true;
        if(sack.dataset.farve === gift.color) score++;
        document.getElementById("scoreDisplay").textContent = "Score: " + score;
        if(gift.imgEl.parentNode) gift.imgEl.parentNode.removeChild(gift.imgEl);
        checkEndGame();
      }
    });
  });
});

// Tjek om spillet skal slutte
function checkEndGame(){
  if(gifts.every(g=>g.caught || !g.imgEl)){
    endScreen.style.display = "block";
    endScreen.textContent = `ðŸŽ‰ Tillykke! Du sorterede ${score} ud af ${gifts.length} gaver! ðŸŽ‰`;
  }
}
</script>
</body>
</html>
