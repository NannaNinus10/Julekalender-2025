<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Låge 7 – Sorter julegaver</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #204226;
  margin: 0;
  padding: 0;
  color: white;
  text-align: center;
}

.content-box {
  background-color: white;
  color: black;
  padding: 20px;
  border-radius: 12px;
  max-width: 500px;
  margin: 40px auto;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  position: relative;
}

#gameArea {
  position: relative;
  width: 400px;
  height: 400px;
  margin: 0 auto;
  overflow: hidden;
}

#maskineBaggrund, #maskineFront {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

#maskineBaggrund { z-index: 0; }
.gift { 
  position: absolute;
  top: 200px;
  z-index: 1;
}
#maskineFront { z-index: 3; }

.sack {
  width: 70px;
  height: 95px;
  margin: 0 5px;
  cursor: pointer;
}

.sacks {
  display: flex;
  justify-content: center;
  margin-top: 10px;
  gap: 10px;
}

.back-button {
  display: inline-block;
  margin-top: 20px;
  padding: 10px 16px;
  background-color: #204226;
  color: white;
  text-decoration: none;
  border-radius: 8px;
  font-weight: bold;
}

.back-button:hover {
  background-color: #35663c;
}

#scoreDisplay {
  font-weight: bold;
  margin-top: 10px;
  font-size: 18px;
  color: #204226;
}
</style>
</head>
<body>
<h1>Glædelig 7. december – Sorter julegaverne!</h1>
<div class="content-box">
  <div id="gameArea">
    <img id="maskineBaggrund" src="../assets/sorterMaskineBag.svg" alt="Baggrund maskine">
    <img id="maskineFront" src="../assets/sorterMaskineFront.svg" alt="Foran maskine">
  </div>

  <div class="sacks">
    <img class="sack" src="../assets/sorterBlåSæk.svg" data-farve="blå">
    <img class="sack" src="../assets/sorterRødSæk.svg" data-farve="rød">
    <img class="sack" src="../assets/sorterGrønSæk.svg" data-farve="grøn">
    <img class="sack" src="../assets/sorterGulSæk.svg" data-farve="gul">
  </div>

  <div id="scoreDisplay">Score: 0</div>
  <p><a href="../index.html" class="back-button">⬅ Tilbage til kalenderen</a></p>
</div>

<script>
const colors = ["blå","rød","grøn","gul"];
const gifts = [];

// 16 pakker: 4 farver × 4 størrelser
colors.forEach(farve => {
  for(let size=1; size<=4; size++){
    gifts.push({color: farve, size: size, caught: false, imgEl: null});
  }
});

let score = 0;
const gameArea = document.getElementById("gameArea");

// Funktion til store bogstaver
function capitalize(s){ return s.charAt(0).toUpperCase() + s.slice(1); }

function spawnGift(gift, delay){
  setTimeout(()=>{
    const img = document.createElement("img");
    img.src = `../assets/sorter${capitalize(gift.color)}${gift.size}.svg`;
    img.classList.add("gift");
    img.style.left = "-40px";
    gameArea.appendChild(img);
    gift.imgEl = img;

    const speed = 1; // langsommere
    const moveInterval = setInterval(()=>{
      if(!img.parentNode){ clearInterval(moveInterval); return; }
      let left = parseFloat(img.style.left);
      img.style.left = (left + speed) + "px";

      if(left > 400){ // passerer højre kant
        clearInterval(moveInterval);
        if(img.parentNode) img.parentNode.removeChild(img);
      }
    }, 20);
  }, delay);
}

// Start alle pakker med forskudt timing, så de ikke overlapper
gifts.forEach((gift, i)=>{
  spawnGift(gift, i * 1000); // 1 sek forskydning
});

// Håndtering af sække: klik tjekker nærmeste pakke under sækken
document.querySelectorAll(".sack").forEach(sack=>{
  sack.addEventListener("click", ()=>{
    const sackLeft = sack.offsetLeft;
    gifts.forEach(gift=>{
      if(gift.caught || !gift.imgEl) return;
      const giftLeft = parseFloat(gift.imgEl.style.left);
      const giftRight = giftLeft + gift.imgEl.width;
      if(giftRight > sackLeft && giftLeft < sackLeft + sack.offsetWidth){
        gift.caught = true;
        if(sack.dataset.farve === gift.color) score++;
        document.getElementById("scoreDisplay").textContent = "Score: " + score;
        if(gift.imgEl.parentNode) gift.imgEl.parentNode.removeChild(gift.imgEl);
      }
    });
  });
});
</script>
</body>
</html>
