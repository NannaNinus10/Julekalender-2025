<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>LÃ¥ge 7 â€“ Sorter julegaver</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #204226;
    margin: 0;
    padding: 0;
    text-align: center;
    color: white;
  }

  .content-box {
    background-color: white;
    color: black;
    padding: 20px;
    border-radius: 12px;
    max-width: 500px;
    margin: 40px auto;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    position: relative;
  }

  #gameArea {
    position: relative;
    width: 400px;
    height: 400px;
    margin: 0 auto;
    overflow: hidden;
  }

  #backgroundBack, #backgroundFront {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
  }

  .gift {
    position: absolute;
    top: 200px; /* BÃ¥ndets Y-vÃ¦rdi */
    z-index: 1;
  }

  .sack {
    position: absolute;
    bottom: 10px;
    width: 80px;
    height: 80px;
    cursor: pointer;
  }

  #sackBlÃ¥ { left: 30px; }
  #sackRÃ¸d { left: 120px; }
  #sackGul { left: 210px; }
  #sackGrÃ¸n { left: 300px; }

  #scoreDisplay {
    margin-top: 10px;
    font-weight: bold;
  }

  #endScreen {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #204226;
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    font-weight: bold;
    z-index: 10;
  }

  .back-button {
    display: inline-block;
    margin-top: 20px;
    padding: 10px 16px;
    background-color: #204226;
    color: white;
    text-decoration: none;
    border-radius: 8px;
    font-weight: bold;
  }

  .back-button:hover {
    background-color: #35663c;
  }
</style>
</head>
<body>
<h1>GlÃ¦delig 7. december â€“ Sorter julegaverne!</h1>

<div class="content-box">
  <div id="gameArea">
    <img id="backgroundBack" src="../assets/sorterMaskineBag.svg" alt="Baggrund bag">
    
    <!-- Gaver indsÃ¦ttes her dynamisk -->
    
    <img id="backgroundFront" src="../assets/sorterMaskineFront.svg" alt="Maskine front">

    <!-- SÃ¦kke -->
    <img id="sackBlÃ¥" class="sack" src="../assets/sorterBlÃ¥SÃ¦k.svg" alt="BlÃ¥ sÃ¦k">
    <img id="sackRÃ¸d" class="sack" src="../assets/sorterRÃ¸dSÃ¦k.svg" alt="RÃ¸d sÃ¦k">
    <img id="sackGul" class="sack" src="../assets/sorterGulSÃ¦k.svg" alt="Gul sÃ¦k">
    <img id="sackGrÃ¸n" class="sack" src="../assets/sorterGrÃ¸nSÃ¦k.svg" alt="GrÃ¸n sÃ¦k">

    <div id="endScreen"></div>
  </div>

  <div id="scoreDisplay">Sorterede gaver: 0</div>

  <p><a href="../index.html" class="back-button">â¬… Tilbage til kalenderen</a></p>
</div>

<script>
const gameArea = document.getElementById("gameArea");
const scoreDisplay = document.getElementById("scoreDisplay");
const endScreen = document.getElementById("endScreen");

const sackMap = {
  blÃ¥: document.getElementById("sackBlÃ¥"),
  rÃ¸d: document.getElementById("sackRÃ¸d"),
  gul: document.getElementById("sackGul"),
  grÃ¸n: document.getElementById("sackGrÃ¸n")
};

const colors = ["blÃ¥", "rÃ¸d", "gul", "grÃ¸n"];
const giftCounts = 4; // 4 gaver per farve
let gifts = [];
let score = 0;

// Opret gaver
colors.forEach(color => {
  for (let i=1; i<=giftCounts; i++) {
    const gift = document.createElement("img");
    gift.src = `../assets/sorter${capitalize(color)}${i}.svg`;
    gift.classList.add("gift");
    gift.dataset.color = color;
    gift.style.left = "-50px"; // starter udenfor venstre kant
    gift.style.top = "200px"; // bÃ¥ndets Y-vÃ¦rdi
    gameArea.appendChild(gift);
    gifts.push(gift);
  }
});

// Randomize rÃ¦kkefÃ¸lge
gifts.sort(() => Math.random()-0.5);

// BevÃ¦g gaver
function moveGifts() {
  gifts.forEach(gift => {
    if (!gift.dataset.caught) {
      let left = parseFloat(gift.style.left);
      left += 2; // hastighed
      gift.style.left = left + "px";

      // Hvis passerer hÃ¸jre kant
      if (left > gameArea.offsetWidth) {
        gift.dataset.caught = "missed";
        checkEndGame();
      }
    }
  });
  requestAnimationFrame(moveGifts);
}

// HÃ¥ndtering af klik pÃ¥ sÃ¦kke
Object.keys(sackMap).forEach(color => {
  sackMap[color].addEventListener("click", () => {
    // Find den gave der er lÃ¦ngst til hÃ¸jre pÃ¥ bÃ¥ndet
    const candidates = gifts.filter(g => !g.dataset.caught);
    if (candidates.length === 0) return;
    let rightmost = candidates.reduce((maxGift, g) => {
      return parseFloat(g.style.left) > parseFloat(maxGift.style.left) ? g : maxGift;
    }, candidates[0]);

    if (rightmost.dataset.color === color) {
      rightmost.dataset.caught = true;
      rightmost.remove();
      score++;
      scoreDisplay.textContent = `Sorterede gaver: ${score}`;
      checkEndGame();
    }
  });
});

// Tjek om spillet er slut
function checkEndGame() {
  if (gifts.every(g => g.dataset.caught)) {
    endScreen.style.display = "block";
    endScreen.textContent = `ðŸŽ‰ Tillykke! Du sorterede ${score} gaver! ðŸŽ‰`;
  }
}

// Start spillet
moveGifts();

// HjÃ¦lpefunktion
function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}
</script>
</body>
</html>
