<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>L√•ge 7 ‚Äì Julegave Sortering</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #204226;
    margin: 0;
    padding: 0;
    text-align: center;
    color: white;
  }

  .content-box {
    background-color: white;
    color: black;
    padding: 20px;
    border-radius: 12px;
    max-width: 500px;
    margin: 40px auto;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    position: relative;
  }

  #gameArea {
    position: relative;
    width: 400px;
    height: 400px;
    margin: 0 auto;
    overflow: hidden;
  }

  #backgroundBack, #backgroundFront {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .gift {
    position: absolute;
    top: 200px; /* b√•ndets Y */
    z-index: 1;
    cursor: default;
  }

  .sack-button {
    margin: 10px 5px;
    padding: 5px;
    border-radius: 8px;
    border: none;
    font-weight: bold;
    cursor: pointer;
  }

  #endScreen {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 15px 20px;
    background-color: #204226;
    color: white;
    font-weight: bold;
    border-radius: 8px;
    z-index: 10;
    text-align: center;
  }

</style>
</head>
<body>
<h1>Gl√¶delig 7. december ‚Äì Sorter gaverne!</h1>

<div class="content-box">
  <div id="gameArea">
    <img id="backgroundBack" src="../assets/sorterMaskineBag.svg" alt="Baggrund bag maskine">
    <div id="endScreen"></div>
    <img id="backgroundFront" src="../assets/sorterMaskineFront.svg" alt="Maskinens front" style="z-index:5;">
  </div>

  <div class="controls">
    <button class="sack-button" data-color="r√∏d" style="background:red;color:white;">R√∏d</button>
    <button class="sack-button" data-color="gr√∏n" style="background:green;color:white;">Gr√∏n</button>
    <button class="sack-button" data-color="gul" style="background:yellow;color:black;">Gul</button>
    <button class="sack-button" data-color="bl√•" style="background:blue;color:white;">Bl√•</button>
  </div>
</div>

<script>
const colors = ["r√∏d","gr√∏n","gul","bl√•"];
const giftsPerColor = 4; 
const totalGifts = colors.length * giftsPerColor; 

// Definer pakke st√∏rrelser (dobbelt)
const giftSizes = {
  1: {width: 53, height: 53},
  2: {width: 68, height: 53},
  3: {width: 60, height: 36},
  4: {width: 38, height: 53}
};

let score = 0;
let gifts = [];

const gameArea = document.getElementById("gameArea");
const endScreen = document.getElementById("endScreen");

// Generer pakker i tilf√¶ldig r√¶kkef√∏lge
function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function generateGifts() {
  let arr = [];
  colors.forEach(color=>{
    for(let i=1;i<=giftsPerColor;i++){
      arr.push({color: color, size: i});
    }
  });
  return shuffle(arr);
}

gifts = generateGifts();

// Spawn og anim√©r pakker
function startGifts() {
  let index = 0;
  const interval = setInterval(()=>{
    if(index>=gifts.length){
      clearInterval(interval);
      checkEnd();
      return;
    }
    const giftData = gifts[index];
    const gift = document.createElement("img");
    gift.src = `../assets/sorter${giftData.color}${giftData.size}.svg`;
    gift.classList.add("gift");
    gift.dataset.color = giftData.color;
    gift.dataset.index = index;
    gift.style.width = giftSizes[giftData.size].width + "px";
    gift.style.height = giftSizes[giftData.size].height + "px";
    gift.style.left = "-50px"; // start venstre udenfor
    gameArea.appendChild(gift);

    // Anim√©r pakke hen over b√•ndet
    let pos = -50;
    const speed = 1.5; 
    const anim = setInterval(()=>{
      pos += speed;
      gift.style.left = pos + "px";

      if(pos > 400){ // passeret h√∏jre kant
        clearInterval(anim);
        gift.remove();
        checkEnd();
      }
    }, 20);

    gift.dataset.anim = anim;
    index++;
  }, 1200);
}

function checkEnd() {
  if(document.querySelectorAll(".gift").length===0){
    endScreen.style.display = "block";
    endScreen.textContent = `üéâ Tillykke! Du sorterede ${score} ud af ${totalGifts} gaver! üéâ`;
  }
}

// S√¶kke knapper
document.querySelectorAll(".sack-button").forEach(btn=>{
  btn.addEventListener("click", ()=>{
    const color = btn.dataset.color;
    const giftsOnB√•nd = Array.from(document.querySelectorAll(".gift"));
    if(giftsOnB√•nd.length===0) return;

    // Find pakke l√¶ngst til h√∏jre
    const rightmost = giftsOnB√•nd.reduce((a,b)=>{
      return parseFloat(a.style.left) > parseFloat(b.style.left) ? a:b;
    });

    if(rightmost.dataset.color===color){
      score++;
      clearInterval(rightmost.dataset.anim);
      rightmost.remove();
      checkEnd();
    }
  });
});

startGifts();
</script>
</body>
</html>
